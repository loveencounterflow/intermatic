{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/main.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n'use strict'\n\n\n# ############################################################################################################\n# CND                       = require 'cnd'\n# rpr                       = CND.rpr\n# badge                     = 'MKTS-GUI-TOOLBOX-FSM'\n# debug                     = CND.get_logger 'debug',     badge\n# warn                      = CND.get_logger 'warn',      badge\n# info                      = CND.get_logger 'info',      badge\n# urge                      = CND.get_logger 'urge',      badge\n# help                      = CND.get_logger 'help',      badge\n# whisper                   = CND.get_logger 'whisper',   badge\n# echo                      = CND.echo.bind CND\n# #...........................................................................................................\n# types                     = new ( require 'intertype' ).Intertype()\n# { isa\n#   validate\n#   declare\n#   type_of }               = types.export()\n# { freeze\n#   lets }                  = require 'letsfreezethat'\nfreeze                    = Object.freeze\n# if globalThis.require?\n#   StateMachine              = require 'javascript-state-machine'\n# Mutimix                   = require 'multimix'\n\n# #-----------------------------------------------------------------------------------------------------------\n# warn = ( message ) ->\n#   if µ?.DOM?.warn?        then µ.DOM.warn message\n#   else if console?.warn?  then console.warn message\n#   else throw new Error message\n#   return null\n\n# #===========================================================================================================\n# class Fsm extends Multimix\n#   constructor: ( fsmd ) ->\n#     # validate.fsmd fsmd\n\n# #===========================================================================================================\n# class Compund_fsm extends Multimix\n#   constructor: ( fsmds ) ->\n#     # validate.fsmds fsmds\n\n\n\n#===========================================================================================================\nclass Intermatic\n\n  #---------------------------------------------------------------------------------------------------------\n  constructor: ( fsmd ) ->\n    # validate.fsmd fsmd\n    @reserved     = freeze [ 'void', 'start', 'stop', 'goto', 'change', 'fail', ]\n    @fsmd         = freeze fsmd\n    @state        = freeze {}\n    @triggers  = {}\n    @state        = 'void'\n    # @states       = {}\n    @before       = {}\n    @enter        = {}\n    @stay         = {}\n    @leave        = {}\n    @after        = {}\n    @_compile_triggers()\n    @_compile_transitioners()\n    @_compile_handlers()\n\n  #---------------------------------------------------------------------------------------------------------\n  fail: ( trigger ) ->\n    throw new Error \"^interstate/fail@556^ trigger not allowed: #{rpr trigger}\"\n\n  #---------------------------------------------------------------------------------------------------------\n  _compile_triggers: ->\n    starred = {}\n    snames  = new Set [ 'void', ]\n    #.......................................................................................................\n    for triplet in @fsmd.triggers ? []\n      ### TAINT validate.list triplet ###\n      ### TAINT validate.tname tname ###\n      ### TAINT validate that free of collision ###\n      [ from_sname, tname, to_sname, ] = triplet\n      #.....................................................................................................\n      ### Special-case starred triggers: ###\n      if from_sname is '*'\n        starred[ tname ] = to_sname\n        continue\n      #.....................................................................................................\n      snames.add from_sname\n      snames.add to_sname\n      ( @triggers[ tname ] ?= {} )[ from_sname ] = to_sname\n    #.......................................................................................................\n    for starred_name, to_sname of starred\n      for from_sname from snames\n        ( @triggers[ starred_name ] ?= {} )[ from_sname ] = to_sname\n    #.......................................................................................................\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _compile_transitioners: ->\n    $key = '^trigger'\n    for tname, from_and_to_states of @triggers\n      do ( tname, from_and_to_states ) =>\n        debug '^3334^', [ tname, from_and_to_states, ]\n        if @[ tname ]?\n          throw new Error \"^interstate/_compile_triggers@516^ transitioner #{rpr tname} already defined\"\n        transitioner = ( P... ) =>\n          ### TAINT use single transitioner method for all triggers? ###\n          from_sname  = @state\n          #-------------------------------------------------------------------------------------------------\n          unless ( to_sname = from_and_to_states[ @state ] )?\n            trigger = freeze { $key, failed: true, from: from_sname, via: tname, }\n            return @fsmd.fail trigger if @fsmd.fail?\n            return @fail trigger\n          #-------------------------------------------------------------------------------------------------\n          ### TAINT rename `trigger` (object w/ data representing the current trajectory) ###\n          changed     = to_sname isnt from_sname\n          trigger     = freeze { $key, from: from_sname, via: tname, to: to_sname, changed, }\n          @before.trigger?          trigger\n          @before.change?           trigger if changed\n          @before[  tname       ]?  trigger\n          @leave[   from_sname  ]?  trigger if changed\n          @state      = to_sname if changed\n          @stay[    to_sname    ]?  trigger if not changed\n          @enter[   to_sname    ]?  trigger if changed\n          @after[   tname       ]?  trigger\n          @after.change?            trigger if changed\n          @after.trigger?           trigger\n          return null\n        @[ tname ] = transitioner\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _compile_handlers: ->\n    ### TAINT add handlers for trigger, change ###\n    ### TAINT check names against reserved ###\n    for category in [ 'before', 'enter', 'stay', 'leave', 'after', ]\n      for name, handler of @fsmd[ category ] ? {}\n        @[ category ][ name ] = handler.bind @\n    return null\n\nif globalThis.require? then module.exports        = { Intermatic, }\nelse                        globalThis.Intermatic = Intermatic\n\n\n\n"
  ]
}